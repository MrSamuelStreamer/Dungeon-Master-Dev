namespace = DMCoremajor

character_event = {
	id = DMCoremajor.1000
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		trait = dungeon_master
		NOT = { has_global_flag = dungeon_master_working_major }
		NOT = {
			has_game_rule = {
				name = dungeon_master_frequency_major
				value = dm_freq_no_major
			}
		}
	}
	immediate = {
		set_global_flag = dungeon_master_working_major
		if = {
			limit = {
				has_game_rule = {
					name = dungeon_master_frequency_major
					value = dm_freq_10_major
				}
			}
			offmap_dungeon_master = {
				offmap_ruler = {
					character_event = { id = DMCoremajor.1 years = 9 random = 365 }
				}
			}
		}
		else_if = {
			limit = {
				has_game_rule = {
					name = dungeon_master_frequency_major
					value = dm_freq_50_major
				}
			}
			offmap_dungeon_master = {
				offmap_ruler = {
					character_event = { id = DMCoremajor.1 years = 45 random = 1825 } # 45 min, 50 max
				}
			}
		}
		else_if = {
			limit = {
				has_game_rule = {
					name = dungeon_master_frequency_major
					value = dm_freq_true_random_major
				}
			}
			offmap_dungeon_master = {
				offmap_ruler = {
					character_event = { id = DMCore.1 years = 1 random = 7300 } # One year minimum, 20 years maximum.
				}
			}
		}
		else = {
			offmap_dungeon_master = {
				offmap_ruler = {
					character_event = { id = DMCoremajor.1 years = 20 random = 1825 } # 20 min, 25 max
				}
			}
		}
	}
}			
character_event = {
	id = DMCoremajor.998
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		offmap_dungeon_master = {
			offmap_ruler = {
				character_event = { id = DMCoremajor.1 days = 5 }
			}
		}
	}
}

character_event = {					#This is a system with a lot of stuff baked in, no repeated events, etc, 
	id = DMCoremajor.1
	hide_window = yes
	is_triggered_only = yes
	offmap = allow

	immediate = {
		clr_global_flag = dungeon_master_working_major
	}
	
	option = {
		# name = DMCoremajor1OptA
		custom_tooltip = {
			text = dungeon_master_rolls
			random_list = {
				1 = {			#event 4
					trigger = {
						NOT = {
							has_global_flag = DMEvent4
						}
					}
					character_event = { id = DMCoreEvt.4 }
					set_global_flag = DMEvent4
				}
				1 = {			#event 15
					trigger = {
						NOT = {
							has_global_flag = DMEvent15
						}
					}
					character_event = { id = DMCoreEvt.15 }
					set_global_flag = DMEvent15
				}
				1 = {			#event 21
					trigger = {
						NOT = {
							has_global_flag = DMEvent21
						}
					}
					character_event = { id = DMCoreEvt.21 }
					set_global_flag = DMEvent21
				}
				1 = {			#event 22
					trigger = {
						NOT = {
							has_global_flag = DMEvent22
						}
					}
					character_event = { id = DMCoreEvt.22 }
					set_global_flag = DMEvent22
				}
				1 = {			#event 24
					trigger = {
						NOT = {
							has_global_flag = DMEvent24
						}
					}
					character_event = { id = DMCoreEvt.24 }
					set_global_flag = DMEvent24
				}
				1 = {			#event 25
					trigger = {
						NOT = {
							has_global_flag = DMEvent25
						}
					}
					character_event = { id = DMCoreEvt.25 }
					set_global_flag = DMEvent25
				}
				1 = {			#event 26
					trigger = {
						NOT = {
							has_global_flag = DMEvent26
						}
					}
					character_event = { id = DMCoreEvt.26 }
					set_global_flag = DMEvent26
				}
				1 = {			#event 29
					trigger = {
						NOT = {
							has_global_flag = DMEvent29
						}
					}
					character_event = { id = DMCoreEvt.29 }
					set_global_flag = DMEvent29
				}
				1 = {			#event 33
					trigger = {
						NOT = {
							has_global_flag = DMEvent33
						}
					}
					narrative_event = { id = DMCoreEvt.33}
					set_global_flag = DMEvent33
				}
				1 = {			#event 39
					trigger = {
						NOT = {
							has_global_flag = DMEvent39
						}
					}
					character_event = { id = DMCoreEvt.39 }
					set_global_flag = DMEvent39
				}
				1 = {			#event 43
					trigger = {
						NOT = {
							has_global_flag = DMEvent43
						}
					}
					character_event = { id = DMCoreEvt.43 }
					set_global_flag = DMEvent43
				}
				1 = {			#event 46
					trigger = {
						NOT = {
							has_global_flag = DMEvent46
						}
					}
					character_event = { id = DMCoreEvt.46 }
					set_global_flag = DMEvent46
				}
				1 = {			#event 53
					trigger = {
						has_dlc = "Holy Fury"
						NOT = {
							has_global_flag = DMEvent53
						}
					}
					character_event = { id = DMCoreEvt.53 }
					set_global_flag = DMEvent53 
				}
				1 = {			#event 54
					trigger = {
						has_dlc = "Reapers"
						NOT = {
							has_global_flag = DMEvent54
						}
					}
					character_event = { id = DMCoreEvt.54 }
					set_global_flag = DMEvent54 
				}
				1 = {			#event 56
					trigger = {
						has_dlc = "Mystics"
						NOT = {
							has_global_flag = DMEvent56
						}
					}
					character_event = { id = DMCoreEvt.56 }
					set_global_flag = DMEvent56
				}
			}
		}
	}
}